<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SAMSIM: mo_init Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SAMSIM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">mo_init Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Allocates Arrays and sets initial data for a given testcase for SAMSIM.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a32008745ff66791f91f74cd2f381f35f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__init.html#a32008745ff66791f91f74cd2f381f35f">init</a> (testcase)</td></tr>
<tr class="memdesc:a32008745ff66791f91f74cd2f381f35f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets initial conditions according to which testcase is chosen.  <a href="#a32008745ff66791f91f74cd2f381f35f">More...</a><br /></td></tr>
<tr class="separator:a32008745ff66791f91f74cd2f381f35f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a745b229176f84ab859f9af8c741f22ba"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__init.html#a745b229176f84ab859f9af8c741f22ba">sub_allocate</a> (Nlayer, length_input_lab)</td></tr>
<tr class="memdesc:a745b229176f84ab859f9af8c741f22ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates Arrays.  <a href="#a745b229176f84ab859f9af8c741f22ba">More...</a><br /></td></tr>
<tr class="separator:a745b229176f84ab859f9af8c741f22ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15996dd79eec9299b5aa0cb64a1e05ad"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__init.html#a15996dd79eec9299b5aa0cb64a1e05ad">sub_allocate_bgc</a> (Nlayer, N_bgc)</td></tr>
<tr class="memdesc:a15996dd79eec9299b5aa0cb64a1e05ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates BGC Arrays.  <a href="#a15996dd79eec9299b5aa0cb64a1e05ad">More...</a><br /></td></tr>
<tr class="separator:a15996dd79eec9299b5aa0cb64a1e05ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd486abfb3ef8b3a6a773d0c9c4b5698"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__init.html#acd486abfb3ef8b3a6a773d0c9c4b5698">sub_deallocate</a></td></tr>
<tr class="memdesc:acd486abfb3ef8b3a6a773d0c9c4b5698"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates Arrays.  <a href="#acd486abfb3ef8b3a6a773d0c9c4b5698">More...</a><br /></td></tr>
<tr class="separator:acd486abfb3ef8b3a6a773d0c9c4b5698"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Allocates Arrays and sets initial data for a given testcase for SAMSIM. </p>
<dl class="section author"><dt>Author</dt><dd>Philipp Griewank</dd></dl>
<p>COPYRIGHT Copyright (c) 2014 Max-Planck-Institut fuer Meteorologie, Hamburg, Germany</p>
<p>Copying and distribution of this file, with or without modification, are permitted in any medium without royalty provided the copyright notice and this notice are preserved. This file is offered as-is, without any warranty.</p>
<dl class="section user"><dt>Revision History</dt><dd>first version created to deal with first multi-layer tests. by Philipp Griewank, IMPRS (2010-07-22) Add Testcases: 101-105 are simulations of master theses experiments 1-5, 111 can be used to compare SAMSIM with salinity harps field data by Niels Fuchs, MPIMET (2017-03-01) </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a32008745ff66791f91f74cd2f381f35f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_init::init </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>testcase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets initial conditions according to which testcase is chosen. </p>
<p>For different initial conditions the Arrays are allocated and the initial values are set. Following must always be:</p><ol type="1">
<li>Nlayer = N_top+N_middle+N_bottom</li>
<li>N_active is set correctly, N_active &lt;= Nlayer</li>
<li>fl_q_bottom &gt;= 0</li>
<li>T_bottom &gt; freezing point of for S_bu_bottom</li>
<li>A too high dt for a too small thick_0 leads to numerical thermodynamic instability. For a conservative guess dt [s] should be smaller than 250000 * (dz [m])**2</li>
</ol>
<p>Testcase 1</p><ul>
<li>Testcase 1 is a replication of lab experiments conducted in tanks cooled from above by a cooling plate using the boundflux_flag 1.</li>
<li>In this testcase the cooling plate Temperature T_top changes every 12 hours to imitate the experiments Dirk Notz conducted in his PhD.</li>
<li>This testcase was used to optimize the free parameters of the gravity drainage parametrization (see Griewank Notz 2013/14).</li>
<li>Can also be run with bgc tracers.</li>
</ul>
<p>Testcase 2</p><ul>
<li>Testcase is an example of how to simulate ice growth and melt in cooling chambers.</li>
<li>Boundflux_flag 3 is used, which uses T2m as the air temperature in the cooling chamber.</li>
<li>The surface flux heat flux is proportional to the ice-air temperature difference (T_top-T2m).</li>
<li>When reproducing cooling chamber experiments the alpha flux parameters need to be tuned, and a module in <a class="el" href="namespacemo__testcase__specifics.html" title="Module contains changes specific testcases require during the main timeloop. ">mo_testcase_specifics</a> is needed to set/ T2m over time.</li>
<li>The heat flux in the water from below (fl_q_bottom) for such experiments can be very hard to reproduce if the heat input is not carefully measured from all pumps or similar devices used.</li>
</ul>
<p>Testcase 3</p><ul>
<li>Uses interpolated climate mean forcing from Notz and a constant oceanic heat flux (fl_q_bottom) to grow idealized arctic sea ice.</li>
<li>Is generally intended as a numerically cheap testcase to check for effects of code changes.</li>
<li>Is also useful when runs over many years are needed.</li>
<li>The amount of liquid and solid precipitation is set in sub_test3 of mo_testcase specifics.</li>
</ul>
<p>Testcase 4</p><ul>
<li>Uses three hourly reanalysis forcing over 4.5 years.</li>
<li>Is set up to start in July.</li>
<li>Prescribes annual cycle of oceanic heat flux.</li>
<li>Requires the proper input data to be copied into the executable folder (see sub_input).</li>
<li>Is more computer intensive</li>
<li>Was used a lot for Griewank &amp; Notz 2013/2014</li>
</ul>
<dl class="section user"><dt>Revision History</dt><dd>First set up by Philipp Griewank, IMPRS (2010-07-22&gt;) </dd></dl>

</div>
</div>
<a class="anchor" id="a745b229176f84ab859f9af8c741f22ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_init::sub_allocate </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>length_input_lab</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates Arrays. </p>
<p>For a given number of layers Nlayers all arrays are allocated</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nlayer</td><td>number of layers</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017 add: dimension of input arrays</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">length_input_lab</td><td>Niels, 2017 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a15996dd79eec9299b5aa0cb64a1e05ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_init::sub_allocate_bgc </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>N_bgc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates BGC Arrays. </p>

</div>
</div>
<a class="anchor" id="acd486abfb3ef8b3a6a773d0c9c4b5698"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_init::sub_deallocate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocates Arrays. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
