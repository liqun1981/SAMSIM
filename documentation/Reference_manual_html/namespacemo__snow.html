<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SAMSIM: mo_snow Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SAMSIM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">mo_snow Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module contains all things directly related to snow.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a47d46adffa14191215072187af009e41"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__snow.html#a47d46adffa14191215072187af009e41">snow_coupling</a> (H_abs_snow, phi_s, T_snow, H_abs, H, phi, T, m_snow, S_abs_snow, m, S_bu)</td></tr>
<tr class="memdesc:a47d46adffa14191215072187af009e41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to couple a thin snow layer to the upper ice layer.  <a href="#a47d46adffa14191215072187af009e41">More...</a><br /></td></tr>
<tr class="separator:a47d46adffa14191215072187af009e41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcac9fd3827efe536b98b56b95bd4d72"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__snow.html#adcac9fd3827efe536b98b56b95bd4d72">snow_precip</a> (m_snow, H_abs_snow, thick_snow, psi_s_snow, dt, liquid_precip_in, T2m, solid_precip_in)</td></tr>
<tr class="memdesc:adcac9fd3827efe536b98b56b95bd4d72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine for calculating precipitation on an existing snow cover.  <a href="#adcac9fd3827efe536b98b56b95bd4d72">More...</a><br /></td></tr>
<tr class="separator:adcac9fd3827efe536b98b56b95bd4d72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3a895585b688139289326e1d87c0df"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__snow.html#aeb3a895585b688139289326e1d87c0df">snow_precip_0</a> (H_abs, S_abs, m, T, dt, liquid_precip_in, T2m, solid_precip_in)</td></tr>
<tr class="memdesc:aeb3a895585b688139289326e1d87c0df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine for calculating precipitation into the ocean.  <a href="#aeb3a895585b688139289326e1d87c0df">More...</a><br /></td></tr>
<tr class="separator:aeb3a895585b688139289326e1d87c0df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab280bd0d9fb25cb6f623f6d03e0eda43"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__snow.html#ab280bd0d9fb25cb6f623f6d03e0eda43">snow_thermo</a> (psi_l_snow, psi_s_snow, psi_g_snow, thick_snow, S_abs_snow, H_abs_snow, m_snow, T_snow, m, thick, H_abs)</td></tr>
<tr class="memdesc:ab280bd0d9fb25cb6f623f6d03e0eda43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine for calculating snow thermodynamics.  <a href="#ab280bd0d9fb25cb6f623f6d03e0eda43">More...</a><br /></td></tr>
<tr class="separator:ab280bd0d9fb25cb6f623f6d03e0eda43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72f70798ac7adc6f23abd0075f427fdf"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__snow.html#a72f70798ac7adc6f23abd0075f427fdf">snow_thermo_meltwater</a> (psi_l_snow, psi_s_snow, psi_g_snow, thick_snow, S_abs_snow, H_abs_snow, m_snow, T_snow, m, thick, H_abs, melt_thick_snow)</td></tr>
<tr class="memdesc:a72f70798ac7adc6f23abd0075f427fdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Niels, 2017 add: Subroutine for calculating snow thermodynamics most of the physics are taken from <a class="el" href="namespacemo__snow.html#ab280bd0d9fb25cb6f623f6d03e0eda43" title="Subroutine for calculating snow thermodynamics. ">snow_thermo()</a> based on lab observations: parts of the snow meltwater percolate directly into the ice.  <a href="#a72f70798ac7adc6f23abd0075f427fdf">More...</a><br /></td></tr>
<tr class="separator:a72f70798ac7adc6f23abd0075f427fdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba287ea5b802ea976ffa642f429a7740"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__snow.html#aba287ea5b802ea976ffa642f429a7740">sub_fl_q_0_snow_thin</a> (m_snow, thick_snow, T_snow, psi_s, psi_l, psi_g, thick, T_bound, fl_Q_snow)</td></tr>
<tr class="memdesc:aba287ea5b802ea976ffa642f429a7740"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines conductive Heat flux for combined top ice and snow layer.  <a href="#aba287ea5b802ea976ffa642f429a7740">More...</a><br /></td></tr>
<tr class="separator:aba287ea5b802ea976ffa642f429a7740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64fd87cbe9f6b396a5b20bb45cefbf5b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__snow.html#a64fd87cbe9f6b396a5b20bb45cefbf5b">sub_fl_q_snow</a> (m_snow, thick_snow, T_snow, psi_s_2, psi_l_2, psi_g_2, thick_2, T_2, fl_Q)</td></tr>
<tr class="memdesc:a64fd87cbe9f6b396a5b20bb45cefbf5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines conductive Heat flux between Snow and top ice layer.  <a href="#a64fd87cbe9f6b396a5b20bb45cefbf5b">More...</a><br /></td></tr>
<tr class="separator:a64fd87cbe9f6b396a5b20bb45cefbf5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2818486537872990f267ad0780bdaae7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__snow.html#a2818486537872990f267ad0780bdaae7">sub_fl_q_0_snow</a> (m_snow, thick_snow, T_snow, T_bound, fl_Q)</td></tr>
<tr class="memdesc:a2818486537872990f267ad0780bdaae7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines conductive Heat between snow layer and upper boundary layer. A limiting factor is added to increase stability of layers thinner then thick_min.  <a href="#a2818486537872990f267ad0780bdaae7">More...</a><br /></td></tr>
<tr class="separator:a2818486537872990f267ad0780bdaae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44802c33fb1c64026eb4b69c0f5cb95a"><td class="memItemLeft" align="right" valign="top">real(wp) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__snow.html#a44802c33fb1c64026eb4b69c0f5cb95a">func_k_snow</a> (m_snow, thick_snow)</td></tr>
<tr class="memdesc:a44802c33fb1c64026eb4b69c0f5cb95a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the thermal conductivity of the snow layer as a function of the density.  <a href="#a44802c33fb1c64026eb4b69c0f5cb95a">More...</a><br /></td></tr>
<tr class="separator:a44802c33fb1c64026eb4b69c0f5cb95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module contains all things directly related to snow. </p>
<dl class="section author"><dt>Author</dt><dd>Philipp Griewank</dd></dl>
<p>COPYRIGHT Copyright (c) 2014 Max-Planck-Institut fuer Meteorologie, Hamburg, Germany</p>
<p>Copying and distribution of this file, with or without modification, are permitted in any medium without royalty provided the copyright notice and this notice are preserved. This file is offered as-is, without any warranty.</p>
<dl class="section user"><dt>Revision History</dt><dd>Provided for by Philipp Griewank 2010-12-13 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a44802c33fb1c64026eb4b69c0f5cb95a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(wp) function, public mo_snow::func_k_snow </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick_snow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the thermal conductivity of the snow layer as a function of the density. </p>
<p>Based on the Sturm et al 1997 data fit for densities greater then 0.156 g/cm**3. Warning, Sturm et al use g/cm**3, I use kg/m**3 Snow density probability functions can be included lated to raise the effective conductivity. Warning!: added 0.15 to the thermal conductivity.</p>
<dl class="section user"><dt>Revision History</dt><dd>Forged by Philipp Griewank (2010-12-13) </dd></dl>

</div>
</div>
<a class="anchor" id="a47d46adffa14191215072187af009e41"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mo_snow::snow_coupling </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>phi_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>T_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>S_abs_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>S_bu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to couple a thin snow layer to the upper ice layer. </p>
<p>Subroutine is activated when thick_snow&lt;thick_min. The enthalpies of the two layers are adjusted until both layers have the same temperatures. The following approach is used.</p><ol type="1">
<li>The enthalpies are adjusted so T_snow=0, and phi_s=1.</li>
<li>The temperatures are calculated.</li>
<li>If the ice temperature is greater 0 the balanced enthalpies are calculated directly. ELSE they are calculated iteratively.</li>
</ol>
<dl class="section user"><dt>Revision History</dt><dd>Written by Philipp Griewank, IMPRS (2011-01-20) </dd></dl>

</div>
</div>
<a class="anchor" id="adcac9fd3827efe536b98b56b95bd4d72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mo_snow::snow_precip </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>thick_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_s_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>liquid_precip_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T2m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in), optional&#160;</td>
          <td class="paramname"><em>solid_precip_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine for calculating precipitation on an existing snow cover. </p>
<p>Can optionally deal with separate solid and liquid precipitation or a single liquid input. The 2 meter temperature determines the temperature of the precipitation. In case of single input the 2 meter temperature determines if snow or rain falls. Snow makes the thickness grow according to the density of new snow(rho_snow), while rain falls into the snow without increasing snow depth. It is necessary to calculate the new psi_s_snow to ensure proper melting in snow_thermo.</p>
<dl class="section user"><dt>Revision History</dt><dd>Sired by Philipp Griewank, IMPRS (2010-12-14) </dd></dl>

</div>
</div>
<a class="anchor" id="aeb3a895585b688139289326e1d87c0df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mo_snow::snow_precip_0 </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>liquid_precip_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T2m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in), optional&#160;</td>
          <td class="paramname"><em>solid_precip_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine for calculating precipitation into the ocean. </p>
<p>Can optionally deal with separate solid and liquid precipitation or a single liquid input. The 2 meter temperature determines the temperature of the precipitation. In case of single input the 2 meter temperature determines if snow or rain falls. It is important, that the mass, energy and salt leaving the upper layer must be outputted. This is not the case. Temp!</p>
<dl class="section user"><dt>Revision History</dt><dd>Copy and Pasted by Philipp Griewank, IMPRS (2011-01-10) </dd></dl>

</div>
</div>
<a class="anchor" id="ab280bd0d9fb25cb6f623f6d03e0eda43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mo_snow::snow_thermo </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_l_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_s_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_g_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>thick_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>S_abs_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>T_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine for calculating snow thermodynamics. </p>
<p>Behaves similar to mushy layer sea ice. Important differences are:</p><ol type="1">
<li>no expulsion, thick_snow is raised if the volume expands.</li>
<li>The liquid fraction is limited.</li>
<li>When the liquid fraction exceeds it's limit the thickness of the snow layer is reduced. This is done as follows: Only applies if the fluid fraction is above the irreducible water content as defined in Coleuo-Lasaffre 98. thick_snow=thick_snow*(1._wp-(psi_s_old-psi_s_snow)/psi_s_old) Warning: the formula for liquid water content in Coleuo-Lasaffre contains 2 typos When the water exceeds the limit water runs down to the bottom of the snow layer. The saturated lower layer is added to the top ice layer.</li>
</ol>
<dl class="section user"><dt>Revision History</dt><dd>Fabricated by Philipp Griewank, IMPRS (2010-12-14) Major redo, water saturated bottom snow added to top ice layer by Philipp Griewank (2010-12-14)</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h_abs</td><td>Top ice layer variables </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a72f70798ac7adc6f23abd0075f427fdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mo_snow::snow_thermo_meltwater </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_l_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_s_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_g_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>thick_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>S_abs_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>T_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>melt_thick_snow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Niels, 2017 add: Subroutine for calculating snow thermodynamics most of the physics are taken from <a class="el" href="namespacemo__snow.html#ab280bd0d9fb25cb6f623f6d03e0eda43" title="Subroutine for calculating snow thermodynamics. ">snow_thermo()</a> based on lab observations: parts of the snow meltwater percolate directly into the ice. </p>
<dl class="section user"><dt>Revision History</dt><dd>introduced by Niels Fuchs (2016-10-13)</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h_abs</td><td>Top ice layer variables </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2818486537872990f267ad0780bdaae7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mo_snow::sub_fl_q_0_snow </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_bound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(out)&#160;</td>
          <td class="paramname"><em>fl_Q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines conductive Heat between snow layer and upper boundary layer. A limiting factor is added to increase stability of layers thinner then thick_min. </p>
<dl class="section user"><dt>Revision History</dt><dd>first version by Philipp Griewank (2010-12-15) Artificial limitation introduced by Philipp Griewank (2011-01-17)</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t_bound</td><td>T_bound temperature of boundary layer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aba287ea5b802ea976ffa642f429a7740"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mo_snow::sub_fl_q_0_snow_thin </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_bound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(out)&#160;</td>
          <td class="paramname"><em>fl_Q_snow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines conductive Heat flux for combined top ice and snow layer. </p>
<p>When thick_snow&lt;thick_min.</p>
<dl class="section user"><dt>Revision History</dt><dd>first version by Philipp Griewank (2011-01-19) </dd></dl>

</div>
</div>
<a class="anchor" id="a64fd87cbe9f6b396a5b20bb45cefbf5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public mo_snow::sub_fl_q_snow </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_s_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_l_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_g_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(out)&#160;</td>
          <td class="paramname"><em>fl_Q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines conductive Heat flux between Snow and top ice layer. </p>
<p>Standard approach.</p>
<dl class="section user"><dt>Revision History</dt><dd>first version by Philipp Griewank (2010-12-15) </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
