<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SAMSIM: mo_functions Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SAMSIM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">mo_functions Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module houses functions which have no home :(.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a015e4051e7772e697a718d90b64ddfad"><td class="memItemLeft" align="right" valign="top">real(wp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#a015e4051e7772e697a718d90b64ddfad">func_density</a> (T, S)</td></tr>
<tr class="memdesc:a015e4051e7772e697a718d90b64ddfad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the physical density for given S and T.  <a href="#a015e4051e7772e697a718d90b64ddfad">More...</a><br /></td></tr>
<tr class="separator:a015e4051e7772e697a718d90b64ddfad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cc948be33dd3afb591adc9a60de2bd9"><td class="memItemLeft" align="right" valign="top">real(wp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#a3cc948be33dd3afb591adc9a60de2bd9">func_freeboard</a> (N_active, Nlayer, psi_s, psi_g, m, thick, m_snow, freeboard_snow_flag)</td></tr>
<tr class="memdesc:a3cc948be33dd3afb591adc9a60de2bd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the freeboard of the 1d ice column.  <a href="#a3cc948be33dd3afb591adc9a60de2bd9">More...</a><br /></td></tr>
<tr class="separator:a3cc948be33dd3afb591adc9a60de2bd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaec1e5ad6d7e3b52bbcb9eaad797333d"><td class="memItemLeft" align="right" valign="top">real(wp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#aaec1e5ad6d7e3b52bbcb9eaad797333d">func_albedo</a> (thick_snow, T_snow, psi_l, thick_min, albedo_flag)</td></tr>
<tr class="memdesc:aaec1e5ad6d7e3b52bbcb9eaad797333d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the albedo.  <a href="#aaec1e5ad6d7e3b52bbcb9eaad797333d">More...</a><br /></td></tr>
<tr class="separator:aaec1e5ad6d7e3b52bbcb9eaad797333d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a882dbdd60aab1c340657d0d653e1dee8"><td class="memItemLeft" align="right" valign="top">real(wp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#a882dbdd60aab1c340657d0d653e1dee8">func_sat_o2</a> (T, S_bu)</td></tr>
<tr class="memdesc:a882dbdd60aab1c340657d0d653e1dee8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the oxygen saturation as a function of salinity and temperature.  <a href="#a882dbdd60aab1c340657d0d653e1dee8">More...</a><br /></td></tr>
<tr class="separator:a882dbdd60aab1c340657d0d653e1dee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01222a7866aac8f09d07f2bfac9643f"><td class="memItemLeft" align="right" valign="top">real(wp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#af01222a7866aac8f09d07f2bfac9643f">func_t_freeze</a> (S_bu, salt_flag)</td></tr>
<tr class="memdesc:af01222a7866aac8f09d07f2bfac9643f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the freezing temperature. Salt_flag determines if either ocean salt or NAcl is used.  <a href="#af01222a7866aac8f09d07f2bfac9643f">More...</a><br /></td></tr>
<tr class="separator:af01222a7866aac8f09d07f2bfac9643f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7420d9fae7442aeb1407179e971c35"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#a3c7420d9fae7442aeb1407179e971c35">sub_notzflux</a> (time, fl_sw, fl_rest)</td></tr>
<tr class="memdesc:a3c7420d9fae7442aeb1407179e971c35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the incoming shortwave and other fluxes according to p. 193-194 PhD Notz.  <a href="#a3c7420d9fae7442aeb1407179e971c35">More...</a><br /></td></tr>
<tr class="separator:a3c7420d9fae7442aeb1407179e971c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbb9a7012e709e4b2b6f402a9831159e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#afbb9a7012e709e4b2b6f402a9831159e">sub_input</a> (length_input, fl_sw_input, fl_lw_input, T2m_input, precip_input, time_input)</td></tr>
<tr class="memdesc:afbb9a7012e709e4b2b6f402a9831159e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads in data for atmoflux_flag ==2.  <a href="#afbb9a7012e709e4b2b6f402a9831159e">More...</a><br /></td></tr>
<tr class="separator:afbb9a7012e709e4b2b6f402a9831159e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea674291e55cedde9a5ec71e45e92dc8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#aea674291e55cedde9a5ec71e45e92dc8">sub_turb_flux</a> (T_bottom, S_bu_bottom, T, S_abs, m, dt, N_bgc, bgc_bottom, bgc_abs)</td></tr>
<tr class="memdesc:aea674291e55cedde9a5ec71e45e92dc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates salt and tracer mixing between lowest layer and underlying water.  <a href="#aea674291e55cedde9a5ec71e45e92dc8">More...</a><br /></td></tr>
<tr class="separator:aea674291e55cedde9a5ec71e45e92dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a463f28035b07b28bba73b8a1100b848a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#a463f28035b07b28bba73b8a1100b848a">sub_melt_thick</a> (psi_l, psi_s, psi_g, T, T_freeze, T_top, fl_Q, thick_snow, dt, melt_thick, thick, thick_min)</td></tr>
<tr class="memdesc:a463f28035b07b28bba73b8a1100b848a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the thickness of the meltwater film.  <a href="#a463f28035b07b28bba73b8a1100b848a">More...</a><br /></td></tr>
<tr class="separator:a463f28035b07b28bba73b8a1100b848a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad19818302426c2848ed285986cf1430d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__functions.html#ad19818302426c2848ed285986cf1430d">sub_melt_snow</a> (melt_thick, thick, thick_snow, H_abs, H_abs_snow, m, m_snow, psi_g_snow)</td></tr>
<tr class="memdesc:ad19818302426c2848ed285986cf1430d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates how the meltwater film interacts with snow.  <a href="#ad19818302426c2848ed285986cf1430d">More...</a><br /></td></tr>
<tr class="separator:ad19818302426c2848ed285986cf1430d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module houses functions which have no home :(. </p>
<p>Created because I wanted to calculate the freeboard separately and didn't know where to put it.</p>
<dl class="section author"><dt>Author</dt><dd>Philipp Griewank </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="aaec1e5ad6d7e3b52bbcb9eaad797333d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(wp) function mo_functions::func_albedo </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>albedo_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the albedo. </p>
<p>Calculates the albedo according to top conditions. This is not a good albedo scheme! It is only a quick approach. Non-continuous switching between wet and dry ice. Linear change from wet ice to water. Linear change from ice_dry snow for snow thinner than 30cm.</p>
<p>psi_l(1)&gt; 0.75 water psi_l(1)&gt; 0.6 linear change from wet ice to water psi_l(1)&gt; 0.2 wet ice psi_l(1)&lt; 0.2 -&gt; dry ice T_snow = 0 -&gt; wet snow T_snow &lt; 0 -&gt; dry snow</p>
<dl class="section user"><dt>Revision History</dt><dd>Built to spill by Philipp Griewank (2011-02-12) </dd></dl>

</div>
</div>
<a class="anchor" id="a015e4051e7772e697a718d90b64ddfad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(wp) function mo_functions::func_density </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the physical density for given S and T. </p>
<p>Although the model treats Salinity as a massless tracer, sometimes it is necessary to determine the exact density for specific purposes. First implemented to calculate simple turbulence between liquid layer and ocean. Uses following simplification of Frank J. Millero and Alain Poisson 1981: Density = density_0 +A*S+B*S**1.5</p>
<dl class="section user"><dt>Revision History</dt><dd>Started by Philipp Griewank (2011-02-24) </dd></dl>

</div>
</div>
<a class="anchor" id="a3cc948be33dd3afb591adc9a60de2bd9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(wp) function mo_functions::func_freeboard </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(nlayer), intent(in)&#160;</td>
          <td class="paramname"><em>psi_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(nlayer), intent(in)&#160;</td>
          <td class="paramname"><em>psi_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(nlayer), intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(nlayer), intent(in)&#160;</td>
          <td class="paramname"><em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>freeboard_snow_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the freeboard of the 1d ice column. </p>
<p>The freeboard is calculated by first finding out which layer is at water level, and then finding out how deep the layer is submerged. For the correct freeboard the mass above water equals the buoyancy of the submerged part. Since the density of each layer is constant, step two can be calculated explicitly. The freeboard is the distance from the top of the ice to the water level. If snow pushes the ice underwater the freeboard becomes negative</p>
<dl class="section user"><dt>Revision History</dt><dd>Built to spill by Philipp Griewank (2011-01-07) <br />
 Negative freeboard included by Philipp Griewank (2011-01-09) <br />
 Patched bug by Philipp Griewank (2011-03-10) <br />
 Add freeboard_snow_flag calculation of snow mass, check the code for further explanations by Niels Fuchs, MPIMET (2017-03-91) <br />
 </dd></dl>

</div>
</div>
<a class="anchor" id="a882dbdd60aab1c340657d0d653e1dee8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(wp) function mo_functions::func_sat_o2 </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>S_bu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the oxygen saturation as a function of salinity and temperature. </p>
<p>Calculates the concentration of oxygen dissolved in freshwater and seawater in equilibrium with the atmosphere The value should be umol/kg. I switched to the solubility of nitrogen, oxygen and argon in water and sea wate from Weiss R.F. 1970 because I couldn't get the other one to work out </p><dl class="section user"><dt>Revision History</dt><dd>Written by Dr. Philipp Griewank (2014-02-25) </dd></dl>

</div>
</div>
<a class="anchor" id="af01222a7866aac8f09d07f2bfac9643f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(wp) function mo_functions::func_t_freeze </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>S_bu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>salt_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the freezing temperature. Salt_flag determines if either ocean salt or NAcl is used. </p>
<dl class="section user"><dt>Revision History</dt><dd>Written to procrastinate by Philipp Griewank (2011-05-05) </dd></dl>

</div>
</div>
<a class="anchor" id="afbb9a7012e709e4b2b6f402a9831159e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_functions::sub_input </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>length_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>fl_sw_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>fl_lw_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>T2m_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>precip_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>time_input</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads in data for atmoflux_flag ==2. </p>
<p>Standard setup used for testcase 4 and all Griewank &amp; Notz 2013/14 reanalysis forced runs is 4.5 years of three hourly values of shortwave incoming, longwave incoming, two meter T, and total precipitation. Data is read from ascii files and stored in long 1D arrays. ERA-interim derived input files in the standard length for various Arctic locations are located under /input/ERA/ Latent and sensible heat fluxes are not included, but could be added if needed.</p>
<dl class="section user"><dt>Revision History</dt><dd>Moved here from <a class="el" href="namespacemo__grotz.html" title="The most important module of SAMSIM. ">mo_grotz</a> by Philipp Griewank (2014-04-20) </dd></dl>

</div>
</div>
<a class="anchor" id="ad19818302426c2848ed285986cf1430d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_functions::sub_melt_snow </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>melt_thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>thick_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>H_abs_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>m_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_g_snow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates how the meltwater film interacts with snow. </p>
<p>Is activated when a thin snow layer (thinner then thick_min) is on top of meltwater. The snow is flooded and turned into ice.</p>
<dl class="section user"><dt>Revision History</dt><dd>Put together by Philipp Griewank (2011-10-17) </dd></dl>

</div>
</div>
<a class="anchor" id="a463f28035b07b28bba73b8a1100b848a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_functions::sub_melt_thick </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>psi_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_freeze</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>fl_Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(out)&#160;</td>
          <td class="paramname"><em>melt_thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>thick_min</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the thickness of the meltwater film. </p>
<p>If the top ice layer is being melted (T_top&gt;T_freeze) it is assumed that a thin meltwater film appears at the top. The thickness of this film is determined by the amount of incoming heat and diffusive transport. The incoming heat is an input (fl_q(1)) and the diffusive heat is (T(1)-T_freeze)/R. See the thermodynamics section for R. The thickness of the meltlayer is determined by dividing the heat intake of the meltwater film by the amount of latent heat needed to melt the solid fraction of the top layer. If the solid fractions sinks below a given threshold (psi_s_top_min) a different approach is used. The melt thickness is then calculated by assuming that the ice below the meltwater film has a solid fraction of psi_s_top_min. Although the thickness can be reduced, variations of mass, salinity and enthalpy are calculated in the flushing subroutine.</p>
<dl class="section user"><dt>Revision History</dt><dd>Introduced by Philipp Griewank (2011-05-09) </dd></dl>

</div>
</div>
<a class="anchor" id="a3c7420d9fae7442aeb1407179e971c35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_functions::sub_notzflux </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(out)&#160;</td>
          <td class="paramname"><em>fl_sw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(out)&#160;</td>
          <td class="paramname"><em>fl_rest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the incoming shortwave and other fluxes according to p. 193-194 PhD Notz. </p>
<p>Simplified version of the Untersteiner Fluxes. Returns only two fluxes as a function of time. Simplified Year, 12 months of 30 days. fl_sw is set to zero for November till February Returns fluxes for day with day zero being 1. Jan. Depending on when the run starts the time should be modified when calling</p>
<dl class="section user"><dt>Revision History</dt><dd>Ripped from Dirk by Philipp Griewank (2011-02-13) </dd></dl>

</div>
</div>
<a class="anchor" id="aea674291e55cedde9a5ec71e45e92dc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_functions::sub_turb_flux </td>
          <td>(</td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>S_bu_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(inout)&#160;</td>
          <td class="paramname"><em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>N_bgc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(n_bgc), intent(in), optional&#160;</td>
          <td class="paramname"><em>bgc_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(wp), dimension(n_bgc), intent(inout), optional&#160;</td>
          <td class="paramname"><em>bgc_abs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates salt and tracer mixing between lowest layer and underlying water. </p>
<p>Very simple turbulence assumption which mixes the lowest layer with the underlying water. Based on assumption that there is a constant amount of turbulence A. This turbulence is amplified when the lowest layer is denser then the ocean mixed layer. And also dampened when the lowest layer is less dense then the mixed layer. Assumption; turb=A*exp(B(density_layer-density_ocean)) A and B set in parameters.i A = turb_A , B = turb_B</p>
<dl class="section user"><dt>Revision History</dt><dd>Moved from grotz by Philipp Griewank (2014-04-2) </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
